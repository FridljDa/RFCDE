knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
devtools::load_all()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
set.seed(42)
generate_data <- function(n) {
x_relevant <- matrix(runif(n * 10), n, 10)
x_irrelevant <- matrix(runif(n * 10), n, 10)
z <- rnorm(n, rowSums(x_relevant), 1)
return(list(x = cbind(x_relevant, x_irrelevant), z = z))
}
n_train <- 10000
n_test <- 4
train_data <- generate_data(n_train)
x_train <- train_data$x
z_train <- train_data$z
n_trees <- 10
mtry <- 4
node_size <- 20
n_basis <- 15
forest <- RFCDE(x_train, z_train, n_trees = n_trees, mtry = mtry,
node_size = node_size, n_basis = n_basis)
forest$rcpp$set_leaves_id()
#x_tests <- c(100,100,99,100,99,5)
terminalNodes1 <- forest$rcpp$traverse_forest(1000)
terminalNodes2 <- forest$rcpp$traverse_forest(200)
terminalNodes3 <- forest$rcpp$traverse_forest(200)
terminalNodes4 <- forest$rcpp$traverse_forest(199)
terminalNodes5 <- forest$rcpp$traverse_forest(0)
rbind(terminalNodes1, terminalNodes2, terminalNodes3, terminalNodes4, terminalNodes5)
x_tests <- seq(0,1,length.out = 5)
terminalNodes <- lapply(x_tests, function(x_test){
return(forest$rcpp$traverse_forest(x_test))
})
terminalNodes <- do.call(rbind, terminalNodes)
terminalNodes
